% arXiv preprint â€” no page limits.
% For HPEC submission: switch to \documentclass[conference]{IEEEtran},
% restore IEEEtran author blocks, \balance, and IEEEtran bibliography style.
\documentclass[11pt]{article}

% --- Page geometry (generous for arXiv preprint) ---
\usepackage[margin=1in]{geometry}

% --- Fonts: Palatino ---
\usepackage[T1]{fontenc}
\usepackage{mathpazo}

% --- Math and symbols ---
\usepackage{amsmath,amssymb}

% --- Algorithms ---
\usepackage{algorithm}
\usepackage{algpseudocode}

% --- Tables ---
\usepackage{booktabs}
\usepackage{array}

% --- Graphics ---
\usepackage{graphicx}
\usepackage{tikz}
\usetikzlibrary{positioning,arrows.meta}

% --- Code listings ---
\usepackage{listings}
\lstset{
  basicstyle=\small\ttfamily,
  columns=fullflexible,
  keepspaces=true,
  escapeinside={(*}{*)},
  xleftmargin=2em,
  aboveskip=0.5\baselineskip,
  belowskip=0.5\baselineskip,
}

% --- Misc ---
\usepackage{xcolor}
\usepackage{pifont}
\usepackage{hyperref}

% --- Macros ---
\newcommand{\Oh}{\mathcal{O}}
\newcommand{\Rel}[1]{\mathit{#1}}
\newcommand{\op}[1]{\textsc{#1}}
\newcommand{\trie}{\textsf{trie}}
\newcommand{\csr}{\textsf{CSR}}

% =====================================================================

\title{Generating Fused Graph Kernels Using Relational Algebra}

\author{Authors \\ Affiliations}

\begin{document}
\maketitle

% --- Abstract ---
\begin{abstract}
Graph algorithms are typically implemented by hand, using operatiions over vertices and
edges.  Expressing them declaratively at the level of graphs enables
systematic optimization of entire classes of graph computations.  One
successful approach exploits the correspondence between graphs and
sparse matrices: GraphBLAS couches graph operations as sparse linear
algebra over user-defined semirings.  This paper explores an
alternative: using the correspondence between graphs and
\emph{relations} to express graph algorithms, and leveraging
optimizations from relational algebra---in particular worst-case
optimal join (WCOJ) algorithms---to generate fused kernels equivalent
to hand-written code.  We show that relational algebra rewrites are
strictly more powerful than linear algebra rewrites for graph
computations with cyclic structure: sparse linear algebra decomposes
computation into pairwise matrix products, producing intermediates up
to $\Oh(M^2)$ in size for patterns such as triangles, 4-cycles, and
cliques, while WCOJ fuses all relations into a single pass, achieving
$\Oh(M^{3/2})$ time matching the AGM bound.  When evaluated over CSR
storage, the fused join generates code identical to hand-written CSR
triangle counting.  Drawing on the SPORES result of Wang et al., we
show that this gap is structural: relational algebra rewrites are
complete for optimizing linear algebra expressions, while the converse
does not hold.  Beyond triangles, for 4-cycles, diamonds, bow-ties,
and $k$-cycles, no masked SpGEMM formulation exists and the pairwise
gap is unavoidable for any cyclic graph pattern.  Performance results
confirm that the
pairwise approach exhibits measurable blowup on high-degree vertices
while the fused approach remains efficient.
\end{abstract}

\input{sec-introduction}
\input{sec-background}
\input{sec-spmm}
\input{sec-triangle}
\input{sec-equivalence}
\input{sec-production}
\input{sec-lazy}
\input{sec-beyond}
\input{sec-experiments}
\input{sec-related}
\input{sec-conclusion}

% --- References ---
\bibliographystyle{plain}
\bibliography{refs}

\end{document}
